#!/bin/bash
# test_01_valid
# Test #1: Valid Certificate

openssl s_client -connect localhost:4443 \
  -servername valid.example.com \
  -CAfile ../serverCA/ca-chain.pem \
  -verify_return_error \
  -brief \
  <<< "Q" 2>&1

EXIT_CODE=$?

# Expected: exit code 0 (verification success)
if [ $EXIT_CODE -eq 0 ]; then
  exit 0  # PASS
else
  echo "Description: Valid certificate was NOT accepted"
  exit 1  # FAIL
fi

